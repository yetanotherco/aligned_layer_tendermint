"use strict";var z=Object.defineProperty;var R=(t,r,e)=>r in t?z(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e;var w=(t,r,e)=>(R(t,typeof r!="symbol"?r+"":r,e),e);Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const W=require("@cosmjs/cosmwasm-stargate");var y="qpzry9x8gf2tvdw0s3jn54khce6mua7l",k={};for(var p=0;p<y.length;p++){var O=y.charAt(p);if(k[O]!==void 0)throw new TypeError(O+" is ambiguous");k[O]=p}function m(t){var r=t>>25;return(t&33554431)<<5^-(r>>0&1)&996825010^-(r>>1&1)&642813549^-(r>>2&1)&513874426^-(r>>3&1)&1027748829^-(r>>4&1)&705979059}function q(t){for(var r=1,e=0;e<t.length;++e){var n=t.charCodeAt(e);if(n<33||n>126)return"Invalid prefix ("+t+")";r=m(r)^n>>5}for(r=m(r),e=0;e<t.length;++e){var a=t.charCodeAt(e);r=m(r)^a&31}return r}function $(t,r,e){if(e=e||90,t.length+7+r.length>e)throw new TypeError("Exceeds length limit");t=t.toLowerCase();var n=q(t);if(typeof n=="string")throw new Error(n);for(var a=t+"1",s=0;s<r.length;++s){var o=r[s];if(o>>5)throw new Error("Non 5-bit word");n=m(n)^o,a+=y.charAt(o)}for(s=0;s<6;++s)n=m(n);for(n^=1,s=0;s<6;++s){var c=n>>(5-s)*5&31;a+=y.charAt(c)}return a}function E(t,r){if(r=r||90,t.length<8)return t+" too short";if(t.length>r)return"Exceeds length limit";var e=t.toLowerCase(),n=t.toUpperCase();if(t!==e&&t!==n)return"Mixed-case string "+t;t=e;var a=t.lastIndexOf("1");if(a===-1)return"No separator character for "+t;if(a===0)return"Missing prefix for "+t;var s=t.slice(0,a),o=t.slice(a+1);if(o.length<6)return"Data too short";var c=q(s);if(typeof c=="string")return c;for(var i=[],u=0;u<o.length;++u){var l=o.charAt(u),A=k[l];if(A===void 0)return"Unknown character "+l;c=m(c)^A,!(u+6>=o.length)&&i.push(A)}return c!==1?"Invalid checksum for "+t:{prefix:s,words:i}}function V(){var t=E.apply(null,arguments);if(typeof t=="object")return t}function P(t){var r=E.apply(null,arguments);if(typeof r=="object")return r;throw new Error(r)}function x(t,r,e,n){for(var a=0,s=0,o=(1<<e)-1,c=[],i=0;i<t.length;++i)for(a=a<<r|t[i],s+=r;s>=e;)s-=e,c.push(a>>s&o);if(n)s>0&&c.push(a<<e-s&o);else{if(s>=r)return"Excess padding";if(a<<e-s&o)return"Non-zero padding"}return c}function T(t){var r=x(t,8,5,!0);if(Array.isArray(r))return r}function G(t){var r=x(t,8,5,!0);if(Array.isArray(r))return r;throw new Error(r)}function K(t){var r=x(t,5,8,!1);if(Array.isArray(r))return r}function J(t){var r=x(t,5,8,!1);if(Array.isArray(r))return r;throw new Error(r)}var f={decodeUnsafe:V,decode:P,encode:$,toWordsUnsafe:T,toWords:G,fromWordsUnsafe:K,fromWords:J},h=(t=>(t.NETWORK="network",t.NOT_FOUND="not-found",t.UNREGISTERED_SERVICE="unregistered-service",t.DUPLICATE_SERVICE="duplicate-service",t.INVALID_ADDRESS="invalid-address",t))(h||{});class d extends Error{constructor(e,n){super(e);w(this,"type");this.name="MatchaError",this.type=n}}const g=class{};let v=g;w(v,"clients",{}),w(v,"getClient",async r=>{let e=g.clients[r];return e===void 0&&(e=await W.CosmWasmClient.connect(r),g.clients[r]=e),e});class N{getCosmWasmClient(r){return v.getClient(r)}}const D={mainnet:"https://rpc.cosmos.directory/osmosis",testnet:"https://rpc-test.osmosis.zone"},U="icns";class Q extends N{constructor(){super(...arguments);w(this,"serviceID",U);w(this,"chain","osmosis");w(this,"contractAddress",{mainnet:"osmo1xk0s8xgktn9x5vwcgtjdxqzadg88fgn33p8u9cnpdxwemvxscvast52cdd",testnet:"osmo1q2qpencrnnlamwalxt6tac2ytl35z5jejn0v4frnp6jff7gwp37sjcnhu5"})}async resolve(e,n,a){var i;const s=await this.getCosmWasmClient(D[n]),[o,c]=e.split(".");try{const u=await(s==null?void 0:s.queryContractSmart(this.contractAddress[n],{address:{name:o,bech32_prefix:c}}));if(!(u!=null&&u.address)||((i=a==null?void 0:a.icns)==null?void 0:i.indexOf(c))===-1)throw new d("",h.NOT_FOUND);return u.address}catch{throw new d("",h.NOT_FOUND)}}async lookup(e,n){const a=await this.getCosmWasmClient(D[n]),s={prefix:null,words:null};try{const{prefix:o,words:c}=f.decode(e);s.prefix=o,s.words=c}catch{throw new d("",h.INVALID_ADDRESS)}try{const o=await(a==null?void 0:a.queryContractSmart(this.contractAddress[n],{primary_name:{address:e}}));if(!(o!=null&&o.name))throw new d("",h.NOT_FOUND);return`${o.name}.${s.prefix}`}catch{throw new d("",h.NOT_FOUND)}}}const _={mainnet:"https://rpc.cosmos.directory/juno",testnet:"https://rpc.uni.kingnodes.com"},b="ibcDomains";class X extends N{constructor(){super(...arguments);w(this,"serviceID",b);w(this,"chain","juno");w(this,"contractAddress",{mainnet:"juno1ce7wjfsuk79t2mdvpdjtv8280pcc64yh9mh62qptuvxe64twt4pqa68z2a",testnet:"juno19al2ptpxz3xk6q8nl3eyvyslkz8g6nz25w48dfpaepwaxavq3mhqsjjqe5"})}async resolve(e,n,a){var i;const s=await this.getCosmWasmClient(_[n]),[o,c]=e.split(".");try{const u=await(s==null?void 0:s.queryContractSmart(this.contractAddress[n],{owner_of:{token_id:o}}));if(!(u!=null&&u.owner)||((i=a==null?void 0:a.ibcDomains)==null?void 0:i.indexOf(c))===-1)throw new d("",h.NOT_FOUND);try{const{words:l}=f.decode(u.owner);return f.encode(c,l)}catch{throw new d("",h.NOT_FOUND)}}catch{throw new d("",h.NOT_FOUND)}}async lookup(e,n){const a=await this.getCosmWasmClient(_[n]),s={prefix:null,words:null};try{const{prefix:c,words:i}=f.decode(e);s.prefix=c,s.words=i}catch{throw new d("",h.INVALID_ADDRESS)}const o=f.encode("juno",s.words);try{const c=await(a==null?void 0:a.queryContractSmart(this.contractAddress[n],{primary_domain:{address:o}}));if(!(c!=null&&c.domain))throw new d("",h.NOT_FOUND);return`${c.domain}.${s.prefix}`}catch{throw new d("",h.NOT_FOUND)}}}const C={mainnet:"https://rpc.cosmos.directory/stargaze",testnet:"https://rpc.elgafar-1.stargaze-apis.com"},I="stargazeNames";class Y extends N{constructor(){super(...arguments);w(this,"serviceID",I);w(this,"chain","stargaze");w(this,"contractAddress",{mainnet:"stars1fx74nkqkw2748av8j7ew7r3xt9cgjqduwn8m0ur5lhe49uhlsasszc5fhr",testnet:"stars1rp5ttjvd5g0vlpltrkyvq62tcrdz949gjtpah000ynh4n2laz52qarz2z8"})}async resolve(e,n,a){var i;const s=await this.getCosmWasmClient(C[n]),[o,c]=e.split(".");try{const u=await s.queryContractSmart(this.contractAddress[n],{associated_address:{name:o}});if(!u||((i=a==null?void 0:a.stargazeNames)==null?void 0:i.indexOf(c))===-1)throw new d("",h.NOT_FOUND);try{const{words:l}=f.decode(u);return f.encode(c,l)}catch{throw new d("",h.NOT_FOUND)}}catch{throw new d("",h.NOT_FOUND)}}async lookup(e,n){const a=await this.getCosmWasmClient(C[n]),s={prefix:null,words:null};try{const{prefix:o,words:c}=f.decode(e);s.prefix=o,s.words=c}catch{throw new d("",h.INVALID_ADDRESS)}try{return`${await a.queryContractSmart(this.contractAddress[n],{name:{address:e}})}.${s.prefix}`}catch{throw new d("",h.NOT_FOUND)}}}const j={mainnet:"https://rpc.mainnet.archway.io",testnet:"https://rpc.constantine.archway.tech"},F="archIds";class Z extends N{constructor(){super(...arguments);w(this,"serviceID",F);w(this,"chain","archway");w(this,"contractAddress",{mainnet:"archway1275jwjpktae4y4y0cdq274a2m0jnpekhttnfuljm6n59wnpyd62qppqxq0",testnet:"archway1lr8rstt40s697hqpedv2nvt27f4cuccqwvly9gnvuszxmcevrlns60xw4r"})}async resolve(e,n,a){var c;const s=await this.getCosmWasmClient(j[n]),[,o]=e.split(".");try{const i=await(s==null?void 0:s.queryContractSmart(this.contractAddress[n],{resolve_record:{name:e}}));if(!(i!=null&&i.address)||((c=a==null?void 0:a.archIds)==null?void 0:c.indexOf(o))===-1)throw new d("",h.NOT_FOUND);return i.address}catch{throw new d("",h.NOT_FOUND)}}async lookup(e,n){var o;const a=await this.getCosmWasmClient(j[n]),s={prefix:null,words:null};try{const{prefix:c,words:i}=f.decode(e);s.prefix=c,s.words=i}catch{throw new d("",h.INVALID_ADDRESS)}try{const c=await(a==null?void 0:a.queryContractSmart(this.contractAddress[n],{resolve_address:{address:e}}));if(!(c!=null&&c.names)||!((o=c==null?void 0:c.names)!=null&&o.length))throw new d("",h.NOT_FOUND);return c.names.join(", ")}catch{throw new d("",h.NOT_FOUND)}}}const S=["agoric","akash","arkh","axelar","band","bcna","bitsong","bostrom","cerberus","certik","cheqd","chihuahua","chronic","comdex","cosmos","crc","cre","cro","cudos","darc","decentr","desmos","dig","echelon","emoney","evmos","fetch","firma","galaxy","genesis","gravity","iaa","inj","ixo","juno","kava","ki","like","logos","lum","mantle","mars","meme","micro","mythos","nomic","octa","odin","orai","osmo","panacea","pb","persistence","regen","rizon","secret","sent","sif","somm","star","stars","swth","terra","thor","umee","vdl","kujira","sei","stride","jkl","tori","omniflix","canto","pasg","archway","quasar","neutron","testcore","core","quick","migaloo","kyve","onomy","noble","plq","nolus","c4e","gitopia","nibi","maya","empower","dydx"],M={icns:S,ibcDomains:S,stargazeNames:S,archIds:["arch"]},B={icns:U,ibcDomains:b,stargazeNames:I,archIds:F},H=M;class L{constructor(r){w(this,"services",{});this.network=r,this.network=r,this.registerService(new Q),this.registerService(new X),this.registerService(new Y),this.registerService(new Z)}registerService(r){if(this.services[r.serviceID])throw new d("Service already registered",h.DUPLICATE_SERVICE);this.services[r.serviceID]=r}getService(r){const e=this.services[r];if(!e)throw new d("Service not registered",h.UNREGISTERED_SERVICE);return e}listServices(){return Object.keys(this.services)}setNetwork(r){this.network=r}getNetwork(){return this.network}async resolve(r,e,n){return this.getService(e).resolve(r,this.network,n)}async lookup(r,e){return this.getService(e).lookup(r,this.network)}async resolveAll(r,e){const n={};return await Promise.all(Object.entries(this.services).map(async([a,s])=>{try{const o=await s.resolve(r,this.network,e);n[a]=o}catch{n[a]=null}})),n}async lookupAll(r){const e={};return await Promise.all(Object.entries(this.services).map(async([n,a])=>{try{const s=await a.lookup(r,this.network);e[n]=s}catch{e[n]=null}})),e}}const rr=new L("mainnet");exports.allowedTopLevelDomains=H;exports.default=rr;exports.services=B;
//# sourceMappingURL=index.cjs.map
